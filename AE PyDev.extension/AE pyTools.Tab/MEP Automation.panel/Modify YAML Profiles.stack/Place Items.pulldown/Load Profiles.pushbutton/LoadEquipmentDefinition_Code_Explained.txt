Load Equipment Definition – Code Explained
=========================================

Use Case
--------
Quickly drop a single equipment definition (parent + children) at a picked
point for review or ad-hoc placement without running the full linked-host
workflow. The script leverages the same placement engine as Place Linked
Elements, so the behavior is consistent with production automation.

Key Steps
---------
1. **Profile Repository** – Load the active YAML, convert it into legacy profile
   objects, and feed them into `ProfileRepository`. This gives us access to the
   exact `LinkedElementDefinition` objects (labels, offsets, tags, static
   parameters).
2. **User Selection** – Prompt the designer to choose which CAD name / equipment
   definition to preview.
3. **Point Capture** – Ask the user for a base point and rotation inside the
   document. That point becomes the “parent anchor” for the temporary placement.
4. **Child Requests** – For each LED in the definition, call
   `build_child_requests` to translate the stored offsets into world coordinates
   relative to the parent point. This produces the same request objects that
   Place Linked Elements consumes.
5. **Placement Engine** – Instantiate `PlaceElementsEngine` with `allow_tags=False`
   (no need to tag during previews) and call `place_from_csv` with the synthesized
   rows. The engine handles activation, rotation, Element_Linker stamping, etc.

Why It Matters
--------------
* Provides a safe, undoable preview of definitions built via Select Parent
  Element/Add Profiles.
* Lets designers verify spacing or parent filters in-context before they commit
  to matching linked hosts.
* Because everything runs through the placement engine, the geometry and
  Element_Linker metadata match exactly what automation will produce later.
