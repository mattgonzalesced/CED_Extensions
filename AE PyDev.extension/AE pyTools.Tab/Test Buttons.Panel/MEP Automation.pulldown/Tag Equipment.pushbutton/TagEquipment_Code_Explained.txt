Tag Equipment – Code Explained
==============================

Purpose
-------
Automatically places the annotation families recorded under the `tags` array of
each linked element definition.  The script reads Element_Linker metadata from
placed instances, pulls tag definitions from the YAML, and instantiates tags in
the active view with the correct offsets and rotation.

Processing Steps
----------------
1. **Scan Instances** – Collects all FamilyInstances with Element_Linker data.
   The payload contains the linked element definition ID, allowing the script to
   map each instance back to the source LED.
2. **Lookup Tag Data** – Using the active YAML, the script finds the tag entry
   for each LED.  Each tag includes family name, type name, offsets, rotation,
   and optional parameter overrides.
3. **Create Tag** – For each tag definition, the script ensures the family is
   loaded and activated, then calls `IndependentTag.Create` or new family
   instance creation depending on whether the tag is a true annotation family or
   a generic annotation.
4. **Apply Offsets and Rotation** – The tag head position is calculated by
   offsetting the host instance location via the stored inches values.  The tag
   is rotated by the stored rotation degrees plus the host orientation to mimic
   the original capture.
5. **Parameter Set** – Any custom parameters defined in the YAML are set on the
   tag (string/integer/double handling mirrors the Add workflow).

Error Handling
--------------
If tag families are missing, the script logs which labels failed so users can
load the required families.  It also skips read-only parameters gracefully.

Undo and Storage
----------------
Tags are created inside a Revit transaction with an identifiable name.  Because
the script does not modify the YAML, there is no Extensible Storage write; the
action is purely geometric.
